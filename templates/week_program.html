<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Week Builder</title>
</head>
<body>
    <h1>Welcome to the Week Builder</h1>

    <button onclick="buildWeekProgram()">Build Week Program</button>
    <!-- <button onclick="displayWeekProgram()">Display Week Program</button> -->

    <br>
    <br>
    <a href="/get_week_program?download=True&type=html&students_number={{students_number}}&professors_number={{professors_number}}"><button>Download html Week Program</button></a>
    <a href="/get_week_program?download=True&type=json&students_number={{students_number}}&professors_number={{professors_number}}"><button>Download json Week Program</button></a>
    <a href="/get_week_program?download=True&type=excel&students_number={{students_number}}&professors_number={{professors_number}}"><button>Download excel Week Program</button></a>

    <div id="weekProgramContainer"></div>

    <script>
        displayWeekProgram()

        async function buildWeekProgram() {
            try {
                let response = await fetch("/generate_week_program", {
                    method: "POST",
                    // body: JSON.stringify({ user_id: 123 })
                });

                // if (response.status != 200) {
                //     throw new Error("Failed to build week program.");
                // }

                // let container = document.getElementById("weekProgramContainer");
                // container.innerHTML = "<h2>Week program built successfully.</h2>";

                displayWeekProgram()

            } catch (error) {
                console.error("Error fetching week program:", error);
            }
        }

        async function displayWeekProgram() {
            try {
                let response = await fetch("/get_week_program?type=html&students_number={{students_number}}&professors_number={{professors_number}}");
                let weekProgram = await response.text();

                let container = document.getElementById("weekProgramContainer");
                container.innerHTML = "<h2>Week Program</h2>" + weekProgram;
            } catch (error) {
                console.error("Error fetching week program:", error);
            }
        }
    </script>
</body>
</html>
